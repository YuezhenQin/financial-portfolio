-- Create the database
CREATE DATABASE finance_db;

-- Use the created database
USE finance_db;


    
    
CREATE TABLE StockInfo(
    id INT AUTO_INCREMENT PRIMARY KEY,
    stockName VARCHAR(100) NOT NULL, 
	currentPrice FLOAT,
    dailyChange FLOAT,
    percentChange FLOAT,
    highPrice FLOAT,
    lowPrice FLOAT,
    openPrice FLOAT,
    closePrice FLOAT,
    infoDate Date
);
    



-- Create the 'User' table
CREATE TABLE user (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    age INT,
    tradeAge INT,
    balance FLOAT
);
-- Insert sample data into the 'user-stock' table

CREATE TABLE userStock (
    id INT AUTO_INCREMENT PRIMARY KEY,
    stockName  VARCHAR(100) NOT NULL,
    userName VARCHAR(100) NOT NULL,
	shares FlOAT,
    purchasePrice FLOAT,
    purchaseDate DATE,
    curStatus INT DEFAULT 1
);

-- INSERT INTO stockinfo 
INSERT INTO `finance_db`.`stockinfo` 
(`id`, `stockName`, `currentPrice`, `dailyChange`, `percentChange`, `highPrice`, `lowPrice`, `openPrice`, `closePrice`, `infoDate`)
VALUES 
(1,'AAPL',216.64,6.26,2.98,217.26,211.67,211.84,216.5,'2024-07-01'),(2,'AAPL',217.17,0.67,0.31,220.13,214.85,215.9,220.02,'2024-07-02'),(3,'AAPL',220.04,0.02,0.01,221.29,218.78,219.75,221.29,'2024-07-03'),(4,'AAPL',223.84,2.55,1.15,226.19,221.39,221.39,226.08,'2024-07-05'),(5,'AAPL',226.29,0.21,0.09,227.59,222.99,226.83,227.56,'2024-07-08'),(6,'AAPL',228.67,1.11,0.49,229.13,226.11,227.67,228.42,'2024-07-09'),(7,'AAPL',230.93,2.51,1.1,232.81,228.98,229.03,232.71,'2024-07-10'),(8,'AAPL',227.34,-5.37,-2.31,232.12,225.51,231.12,227.31,'2024-07-11'),(9,'AAPL',232.07,4.76,2.09,232.37,228.42,228.66,230.27,'2024-07-12'),(10,'AAPL',236.72,6.45,2.8,236.96,232.82,236.21,234.13,'2024-07-15'),(11,'AAPL',233.95,-0.18,-0.08,236,232.06,234.73,234.55,'2024-07-16'),(12,'AAPL',229.09,-5.46,-2.33,231.19,226.38,229.18,228.62,'2024-07-17'),(13,'AAPL',222.13,-6.49,-2.84,230.17,222.01,230.01,223.92,'2024-07-18'),(14,'AAPL',224.86,0.94,0.42,226.54,223.02,224.56,224.05,'2024-07-19'),(15,'AAPL',225,0.95,0.42,227.52,222.83,226.75,223.7,'2024-07-22'),(16,'AAPL',224.08,0.38,0.17,226.68,222.42,224.11,224.75,'2024-07-23'),(17,'AAPL',217.33,-7.42,-3.3,224.54,216.88,223.74,218.29,'2024-07-24'),(18,'AAPL',216.93,-1.36,-0.62,220.59,214.37,218.68,217.24,'2024-07-25'),(19,'AAPL',217.76,0.52,0.24,219.24,215.76,218.45,217.71,'2024-07-26'),(20,'AAPL',216.24,-1.47,-0.68,219.05,215.5,216.71,217.99,'2024-07-29'),(21,'AAPL',218.12,0.13,0.06,220.08,215.87,218.94,218.55,'2024-07-30'),(22,'AAPL',220.59,2.04,0.93,223.56,220.37,221.18,221.82,'2024-07-31'),(23,'AAPL',221.5,-0.32,-0.14,224.22,216.77,224.11,218.11,'2024-08-01'),(24,'AAPL',221.38,3.27,1.5,225.34,217.46,218.9,219.61,'2024-08-02'),(25,'AAPL',212.14,-7.47,-3.4,213.25,195.77,198.86,209.03,'2024-08-05'),(26,'AAPL',206.52,-2.51,-1.2,209.75,200.84,205.06,206.99,'2024-08-06'),(27,'AAPL',212.54,5.55,2.68,213.39,206.15,206.66,209.58,'2024-08-07'),(28,'AAPL',210.7,1.12,0.53,213.95,208.59,212.86,213.06,'2024-08-08'),(29,'AAPL',213.61,0.55,0.26,216.53,211.72,211.85,215.99,'2024-08-09'),(30,'AAPL',218.61,2.62,1.21,219.51,215.6,216.07,217.53,'2024-08-12'),(31,'AAPL',220.13,2.6,1.2,221.89,219.01,219.01,221.27,'2024-08-13'),(32,'AAPL',222.21,0.94,0.42,223.03,219.7,220.57,221.72,'2024-08-14'),(33,'AAPL',223.59,1.87,0.84,225.35,222.76,224.6,224.72,'2024-08-15'),(34,'AAPL',226.57,1.85,0.82,226.83,223.65,223.92,226.05,'2024-08-16'),(35,'AAPL',223.29,-2.76,-1.22,225.99,223.04,225.72,225.89,'2024-08-19'),(36,'AAPL',226.06,0.17,0.08,227.17,225.45,225.77,226.51,'2024-08-20'),(37,'AAPL',226.5,-0.01,-0,227.98,225.05,226.52,226.4,'2024-08-21'),(38,'AAPL',228.18,1.78,0.79,228.34,223.9,227.79,224.53,'2024-08-22'),(39,'AAPL',224.93,0.4,0.18,228.22,224.33,225.66,226.84,'2024-08-23'),(40,'ABNB',151.86,0.23,0.15,152.2,149.14,152.2,151.63,'2024-07-01'),(41,'ABNB',153.01,1.38,0.91,155.21,151.29,151.29,154.34,'2024-07-02'),(42,'ABNB',153.37,-0.97,-0.63,154.43,152.3,153.91,152.73,'2024-07-03'),(43,'ABNB',152.17,-0.56,-0.37,152.88,151.44,152.4,152.5,'2024-07-05'),(44,'ABNB',153.23,0.73,0.48,154.2,150.76,152.65,151.96,'2024-07-08'),(45,'ABNB',155.09,3.13,2.06,155.66,151.96,152.92,152.45,'2024-07-09'),(46,'ABNB',151.67,-0.78,-0.51,153.2,150.09,153.11,151.84,'2024-07-10'),(47,'ABNB',146.31,-5.53,-3.64,152,144.13,150.55,146,'2024-07-11'),(48,'ABNB',147.86,1.86,1.27,148,146.19,146.83,146.78,'2024-07-12'),(49,'ABNB',148.26,1.48,1.01,148.47,144.75,145.88,147.22,'2024-07-15'),(50,'ABNB',149.68,2.46,1.67,151.64,147.88,148.47,151.26,'2024-07-16'),(51,'ABNB',148.86,-2.4,-1.59,150.1,147.26,149.24,148,'2024-07-17'),(52,'ABNB',146.8,-1.2,-0.81,150.15,146.75,148.17,146.88,'2024-07-18'),(53,'ABNB',148.14,1.26,0.86,149.16,147.03,147.03,147.99,'2024-07-19'),(54,'ABNB',148.32,0.33,0.22,150.37,146.55,148.14,150.18,'2024-07-22'),(55,'ABNB',149.16,-1.02,-0.68,151.25,147.83,150.56,148.75,'2024-07-23'),(56,'ABNB',143.22,-5.53,-3.72,147.11,142.98,146.73,144.23,'2024-07-24'),(57,'ABNB',139.38,-4.85,-3.36,141.95,137.58,141.25,140.03,'2024-07-25'),(58,'ABNB',140.69,0.66,0.47,141.91,139.03,141.9,140.1,'2024-07-26'),(59,'ABNB',140.51,0.41,0.29,142.43,140,141.24,140.29,'2024-07-29'),(60,'ABNB',139.55,-0.74,-0.53,140.99,137.9,140.65,138.99,'2024-07-30'),(61,'ABNB',139.24,0.25,0.18,141.22,139.1,140.79,139.56,'2024-07-31'),(62,'ABNB',137.27,-2.29,-1.64,139.78,132.9,139.7,135.09,'2024-08-01'),(63,'ABNB',128.04,-7.05,-5.22,129.6,126.5,129.31,128.23,'2024-08-02'),(64,'ABNB',125.7,-2.53,-1.97,125.95,122.06,123.77,125.31,'2024-08-05'),(65,'ABNB',129.58,4.27,3.41,131.45,126.3,126.9,130.47,'2024-08-06'),(66,'ABNB',114.94,-15.53,-11.9,115.55,110.38,112.44,113.01,'2024-08-07'),(67,'ABNB',114,0.99,0.88,116.43,112.42,113.98,114.64,'2024-08-08'),(68,'ABNB',114.03,-0.61,-0.53,116.26,112.6,114.46,115.08,'2024-08-09'),(69,'ABNB',114.98,-0.1,-0.09,115.5,113.27,115.48,113.62,'2024-08-12'),(70,'ABNB',115.5,1.88,1.65,117.77,114.05,114.39,116.9,'2024-08-13'),(71,'ABNB',118.11,1.21,1.04,118.74,116.18,117.72,116.24,'2024-08-14'),(72,'ABNB',117.26,1.02,0.88,119.13,116.37,118.19,118.88,'2024-08-15'),(73,'ABNB',118.59,-0.29,-0.24,118.8,116.22,117.9,116.31,'2024-08-16'),(74,'ABNB',116.68,0.37,0.32,119.3,116.44,116.93,119.14,'2024-08-19'),(75,'ABNB',117.92,-1.22,-1.02,119.28,117.18,118.94,117.38,'2024-08-20'),(76,'ABNB',117.48,0.1,0.09,118.27,116.7,118.04,117.68,'2024-08-21'),(77,'ABNB',118.28,0.6,0.51,118.39,115.3,117.68,115.45,'2024-08-22'),(78,'ABNB',116.73,1.28,1.11,118.7,116.37,116.64,116.85,'2024-08-23'),(79,'AMGN',315.83,5.54,1.79,316.79,308.08,311.17,308.86,'2024-07-01'),(80,'AMGN',307.6,-1.26,-0.41,310.27,305.51,308.1,308.62,'2024-07-02'),(81,'AMGN',307.21,-1.41,-0.46,310.38,303.99,309.34,307.24,'2024-07-03'),(82,'AMGN',308.89,1.65,0.54,311.24,306.44,308.88,308.73,'2024-07-05'),(83,'AMGN',311.94,3.21,1.04,313.3,308.46,309.21,309.31,'2024-07-08'),(84,'AMGN',312.6,3.29,1.06,313.89,305.5,309.47,313.73,'2024-07-09'),(85,'AMGN',316.63,2.9,0.92,320.65,312.46,314.87,319.45,'2024-07-10'),(86,'AMGN',320.12,0.67,0.21,325.72,317.97,319.77,322.84,'2024-07-11'),(87,'AMGN',330.94,8.1,2.51,331.54,323.76,325.55,328.54,'2024-07-12'),(88,'AMGN',330.23,1.69,0.51,330.51,325.6,329.59,327.87,'2024-07-15'),(89,'AMGN',329.5,1.63,0.5,333.59,325.73,328.17,330.84,'2024-07-16'),(90,'AMGN',330.81,-0.03,-0.01,334.28,326.33,327.72,333.35,'2024-07-17'),(91,'AMGN',328.5,-4.85,-1.45,336.64,328.38,331.89,328.68,'2024-07-18'),(92,'AMGN',329.03,0.35,0.11,331.67,326.16,331.34,329,'2024-07-19'),(93,'AMGN',332.29,3.29,1,334.76,330.17,330.93,333.65,'2024-07-22'),(94,'AMGN',331.23,-2.42,-0.73,334.71,329.02,332.05,330.94,'2024-07-23'),(95,'AMGN',328.46,-2.48,-0.75,334.85,328.06,330.95,333.29,'2024-07-24'),(96,'AMGN',336.37,3.08,0.92,344.45,330.72,333.67,331.99,'2024-07-25'),(97,'AMGN',334.22,2.23,0.67,336.6,330.98,332.25,332.53,'2024-07-26'),(98,'AMGN',329.74,-2.79,-0.84,332.52,329.01,331.77,330.21,'2024-07-29'),(99,'AMGN',333.04,2.83,0.86,336.23,329.38,330.7,330.98,'2024-07-30'),(100,'AMGN',328.67,-2.31,-0.7,334.08,328.28,329.26,330.17,'2024-07-31'),(101,'AMGN',335.84,5.67,1.72,338.53,331.15,333.77,333.21,'2024-08-01'),(102,'AMGN',329.71,-3.5,-1.05,336.01,323.48,335.09,331.68,'2024-08-02'),(103,'AMGN',330.28,-1.4,-0.42,331.04,319.19,330.42,322.97,'2024-08-05'),(104,'AMGN',327.27,4.3,1.33,330.68,321.28,322.98,326.68,'2024-08-06'),(105,'AMGN',318.85,-7.83,-2.4,320.77,304.47,318.77,310.34,'2024-08-07'),(106,'AMGN',315.45,5.11,1.65,322.87,310.63,311.83,322.44,'2024-08-08'),(107,'AMGN',319.34,-3.1,-0.96,322.79,317.12,321.51,320.26,'2024-08-09'),(108,'AMGN',320.29,0.03,0.01,321.66,315.73,321.66,317.79,'2024-08-12'),(109,'AMGN',318.83,1.04,0.33,321.76,316.96,319.55,321.21,'2024-08-13'),(110,'AMGN',320.95,-0.26,-0.08,322.12,317.35,318.21,320.5,'2024-08-14'),(111,'AMGN',321.37,0.87,0.27,324.9,319.71,321.64,323.14,'2024-08-15'),(112,'AMGN',324.46,1.32,0.41,324.82,320.5,323.65,321.44,'2024-08-16'),(113,'AMGN',321.98,0.54,0.17,328.18,321.41,321.46,327.97,'2024-08-19'),(114,'AMGN',328,0.03,0.01,330.5,326.62,328.12,328.55,'2024-08-20'),(115,'AMGN',329.44,0.89,0.27,330.99,327.91,329.55,329.15,'2024-08-21'),(116,'AMGN',329.27,0.12,0.04,329.5,323.12,329.5,324.53,'2024-08-22'),(117,'AMGN',326.3,1.77,0.55,331.29,325.38,326.27,328.8,'2024-08-23'),(118,'AMZN',197.69,4.44,2.3,198.3,192.82,193.49,197.2,'2024-07-01'),(119,'AMZN',197.91,0.71,0.36,200.43,195.93,197.28,200,'2024-07-02'),(120,'AMZN',198.41,-1.59,-0.8,200.03,196.76,199.94,197.59,'2024-07-03'),(121,'AMZN',199.38,1.79,0.91,200.55,198.17,198.65,200,'2024-07-05'),(122,'AMZN',200.29,0.29,0.14,201.2,197.96,200.04,199.29,'2024-07-08'),(123,'AMZN',200.34,1.05,0.53,200.57,199.05,199.4,199.34,'2024-07-09'),(124,'AMZN',198.92,-0.42,-0.21,200.11,197.69,200,199.79,'2024-07-10'),(125,'AMZN',194.92,-4.87,-2.44,200.27,192.86,200.09,195.05,'2024-07-11'),(126,'AMZN',196.27,1.22,0.63,196.47,193.83,194.8,194.49,'2024-07-12'),(127,'AMZN',195.89,1.4,0.72,196.19,190.83,194.56,192.72,'2024-07-15'),(128,'AMZN',194.34,1.62,0.84,196.62,192.24,195.59,193.02,'2024-07-16'),(129,'AMZN',189.14,-3.88,-2.01,191.58,185.99,191.35,187.93,'2024-07-17'),(130,'AMZN',181.56,-6.37,-3.39,189.68,181.45,189.59,183.75,'2024-07-18'),(131,'AMZN',182.62,-1.13,-0.61,184.93,180.11,181.14,183.13,'2024-07-19'),(132,'AMZN',183.67,0.54,0.29,185.06,182.48,185,182.55,'2024-07-22'),(133,'AMZN',185.83,3.28,1.8,189.39,183.56,184.1,186.41,'2024-07-23'),(134,'AMZN',180.71,-5.7,-3.06,185.45,180.41,183.2,180.83,'2024-07-24'),(135,'AMZN',179.72,-1.11,-0.61,183.9,176.8,182.91,179.85,'2024-07-25'),(136,'AMZN',181.94,2.09,1.16,183.19,180.24,180.39,182.5,'2024-07-26'),(137,'AMZN',182.87,0.37,0.2,184.75,182.38,183.84,183.2,'2024-07-29'),(138,'AMZN',182.84,-0.36,-0.2,185.86,179.38,184.72,181.71,'2024-07-30'),(139,'AMZN',184.69,2.98,1.64,187.94,184.46,185.05,186.98,'2024-07-31'),(140,'AMZN',187.41,0.43,0.23,190.6,181.87,189.29,184.07,'2024-08-01'),(141,'AMZN',164.64,-19.43,-10.56,168.77,160.55,166.75,167.9,'2024-08-02'),(142,'AMZN',162.24,-5.66,-3.37,162.96,151.61,154.21,161.02,'2024-08-05'),(143,'AMZN',162.71,1.69,1.05,165.08,158.54,161.71,161.93,'2024-08-06'),(144,'AMZN',166.86,4.93,3.04,167.58,161.43,166.55,162.77,'2024-08-07'),(145,'AMZN',164.18,1.41,0.87,166.69,162.55,165.17,165.8,'2024-08-08'),(146,'AMZN',166.91,1.11,0.67,168.55,165.85,166.4,166.94,'2024-08-09'),(147,'AMZN',167.99,1.05,0.63,168.55,166.11,168.14,166.8,'2024-08-12'),(148,'AMZN',168.64,1.84,1.1,171.04,167.1,167.81,170.23,'2024-08-13'),(149,'AMZN',171.44,1.21,0.71,172.28,168.86,172.11,170.1,'2024-08-14'),(150,'AMZN',175.25,5.15,3.03,177.91,173.99,174.86,177.59,'2024-08-15'),(151,'AMZN',178.17,0.58,0.33,178.34,176.26,177.04,177.06,'2024-08-16'),(152,'AMZN',176.34,-0.72,-0.41,178.3,176.16,177.64,178.22,'2024-08-19'),(153,'AMZN',177.99,-0.23,-0.13,179.01,177.43,177.92,178.88,'2024-08-20'),(154,'AMZN',180.63,1.75,0.98,182.39,178.89,179.92,180.11,'2024-08-21'),(155,'AMZN',181.26,1.15,0.64,181.47,175.68,181.38,176.13,'2024-08-22'),(156,'AMZN',175.82,-0.31,-0.18,178.97,175.24,177.34,177.04,'2024-08-23'),(157,'AXP',233.74,2.88,1.25,234.1,230.86,231.64,233.12,'2024-07-01'),(158,'AXP',233.69,0.57,0.24,235.49,232.28,232.86,235.27,'2024-07-02'),(159,'AXP',235.69,0.42,0.18,236.87,234.49,235.8,235.01,'2024-07-03'),(160,'AXP',235.16,0.15,0.06,236.7,233.56,235.71,235.63,'2024-07-05'),(161,'AXP',237.88,2.25,0.95,239.5,233.76,236.23,234.51,'2024-07-08'),(162,'AXP',238.41,3.9,1.66,239.2,234.12,234.97,237.75,'2024-07-09'),(163,'AXP',237.57,-0.18,-0.08,239.45,235.62,236.57,238.93,'2024-07-10'),(164,'AXP',237.79,-1.14,-0.48,239.95,236.96,238.87,238.75,'2024-07-11'),(165,'AXP',240.03,1.28,0.54,240.26,237.23,238.97,238.63,'2024-07-12'),(166,'AXP',244.42,5.79,2.43,244.66,240.45,240.45,244,'2024-07-15'),(167,'AXP',246.66,2.66,1.09,249.76,243.8,244.14,249.63,'2024-07-16'),(168,'AXP',249.33,-0.3,-0.12,250.84,247.38,248.81,249.96,'2024-07-17'),(169,'AXP',247.84,-2.12,-0.85,253.73,247.76,250.8,249.2,'2024-07-18'),(170,'AXP',240.64,-8.56,-3.43,243.38,237.65,241.8,242.38,'2024-07-19'),(171,'AXP',242.54,0.16,0.07,245.61,239.9,243.01,244.75,'2024-07-22'),(172,'AXP',246.58,1.83,0.75,248.99,245.04,246.96,246.9,'2024-07-23'),(173,'AXP',240.96,-5.94,-2.41,245.62,240.67,245,240.99,'2024-07-24'),(174,'AXP',241.68,0.69,0.29,244.96,239.39,240,240.18,'2024-07-25'),(175,'AXP',244.48,4.3,1.79,246.39,241.88,241.93,245.89,'2024-07-26'),(176,'AXP',245.07,-0.82,-0.33,247.96,244.31,246.63,247.89,'2024-07-29'),(177,'AXP',251.61,3.72,1.5,253.68,249.23,249.46,252.48,'2024-07-30'),(178,'AXP',252.69,0.21,0.08,256.24,252.43,253.11,253.04,'2024-07-31'),(179,'AXP',251.87,-1.17,-0.46,255,246.41,253.85,248.68,'2024-08-01'),(180,'AXP',237.31,-11.37,-4.57,244.65,230.05,244.51,232.28,'2024-08-02'),(181,'AXP',230.22,-2.06,-0.89,230.78,222.03,226.64,225.92,'2024-08-05'),(182,'AXP',230.76,4.84,2.14,233.18,226.5,226.96,231.12,'2024-08-06'),(183,'AXP',235.27,4.15,1.8,236.17,228.51,234.02,228.8,'2024-08-07'),(184,'AXP',232.38,3.58,1.56,234.5,231.01,231.05,233.54,'2024-08-08'),(185,'AXP',235.15,1.61,0.69,238.34,233.09,233.52,237.85,'2024-08-09'),(186,'AXP',238.16,0.31,0.13,238.99,235.4,238.2,237.05,'2024-08-12'),(187,'AXP',237.56,0.51,0.22,239.27,236.47,238.71,238.99,'2024-08-13'),(188,'AXP',242.97,3.98,1.67,244.09,239.51,239.81,243.76,'2024-08-14'),(189,'AXP',246.96,3.2,1.31,250.36,245.35,247.77,249.5,'2024-08-15'),(190,'AXP',251.53,2.03,0.81,251.75,249.13,249.39,251.71,'2024-08-16'),(191,'AXP',252.03,0.32,0.13,254.11,251.84,252,254.05,'2024-08-19'),(192,'AXP',253.1,-0.95,-0.37,254.62,252.26,254.22,253.08,'2024-08-20'),(193,'AXP',246.56,-6.52,-2.58,249.82,243.35,249.64,246.3,'2024-08-21'),(194,'AXP',248.8,2.5,1.02,248.92,245.76,246.77,247.76,'2024-08-22'),(195,'AXP',248.65,0.89,0.36,252.17,248,248,251.3,'2024-08-23');

INSERT INTO `finance_db`.`user` 
(`name`, `age`, `tradeAge`, `balance`)
VALUES 
('David', '18', '3', '500000'),
('Jack', '18', '4', '500000'),
('Q', '18', '5', '500000'),
('ZiHui', '18', '6', '500000');

INSERT INTO `finance_db`.`userStock` 
(`stockName`, `userName`, `shares`, `purchasePrice`, `purchaseDate`,`curStatus`)
VALUES 
('AAPL', 'David', '3', '100', '2024-08-27','1'),
('ABNB', 'Jack', '10', '100', '2024-08-27','1');

-- allow update without where statement
SET SQL_SAFE_UPDATES = 0;

-- update purchase date to random date between 2024-7-1 and 2024-8-23
update userstock
set purchaseDate = CURRENT_DATE - INTERVAL FLOOR(RAND() * 54) DAY;

-- update purchase price to the closing price of the purchase date
UPDATE userstock
JOIN stockinfo ON userstock.purchaseDate = stockinfo.infoDate
SET userstock.purchasePrice = stockinfo.closePrice;

-- test
select purchasePrice from userstock;
select purchaseDate from userstock;


